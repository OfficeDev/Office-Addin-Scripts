steps:
# Build packages in dependency order without using Lerna or npm workspaces
# Each package is built by calling npm run build directly in its directory

- script: |
    echo  "==== Level 0: No internal dependencies ===="
    echo "Building office-addin-prettier-config..."
    echo "No build script found, skipping..."

    echo "==== Level 1: Depends only on Level 0 ===="
    echo "Building eslint-plugin-office-addins..."
    cd packages/eslint-plugin-office-addins
    npm run build
    echo "Building office-addin-usage-data..."
    cd packages/office-addin-usage-data
    npm run build

    echo "==== Level 2: Depends on Level 0-1 ===="
    echo "Building office-addin-cli..."
    cd packages/office-addin-cli
    npm run build
    echo "Building eslint-config-office-addins..."
    cd packages/eslint-config-office-addins
    npm run build
    echo "Building office-addin-lint..."
    cd packages/office-addin-lint
    npm run build

    echo "==== Level 3: Depends on Level 0-2 ===="
    echo "Building office-addin-node-debugger..."
    cd packages/office-addin-node-debugger
    npm run build
    echo "Building office-addin-manifest..."
    cd packages/office-addin-manifest
    npm run build
    echo "Building custom-functions-metadata..."
    cd packages/custom-functions-metadata
    npm run build
    echo "Building eslint-plugin-excel-custom-functions..."
    cd packages/eslint-plugin-excel-custom-functions
    npm run build

    echo "==== Level 4: Depends on Level 0-3 ===="
    echo "Building office-addin-dev-certs..."
    cd packages/office-addin-dev-certs
    npm run build
    echo "Building office-addin-dev-settings..."
    cd packages/office-addin-dev-settings
    npm run build
    echo "Building office-addin-mock..."
    cd packages/office-addin-mock
    npm run build
    echo "Building office-addin-project..."
    cd packages/office-addin-project
    npm run build
    echo "Building custom-functions-metadata-plugin..."
    cd packages/custom-functions-metadata-plugin
    npm run build

    echo "==== Level 5: Depends on Level 0-4 ===="
    echo "Building office-addin-test-server..."
    cd packages/office-addin-test-server
    npm run build
    echo "Building office-addin-debugging..."
    cd packages/office-addin-debugging
    npm run build
    cd packages/office-addin-sso
    npm run build

    echo "==== Level 6: Depends on Level 0-5 ===="
    echo "Building office-addin-test-helpers..."
    cd packages/office-addin-test-helpers
    npm run build
  displayName: 'Build package individually'
  continueOnError: true